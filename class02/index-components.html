<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Vue v-for Example (Options API)</title>
  <!-- 1. Include Vue from a CDN -->
  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
  <style>
    span.tag{
        background-color: #f0f0f0;
        padding: 2px 8px;
        border-radius: 4px;
        margin-right: 5px;
        color: #555;
        font-size: 0.8rem;
    }
  </style>
  </head>
<body>
  <!-- This is where your Vue app will be mounted -->
<div id="app">
    <title-component title="Latest Posts (Learning Component)"></title-component>
    <hr>
    <div v-if="loading">
        <p>Loading posts...</p>
    </div>
    <div v-else-if="error" class="error-message">
        <p>Error: {{ error }}</p>
    </div>
    <div v-else>
        <div class="posts-container">
            <single-article v-for="post in sortedPosts" :key="post.id" :post="post"></single-article>
        </div>
        <hr>
    </div>
  </div>
</body>
<script>
    //tag component
            const tagComponent = {
            props: ['tag'],
            template: `<span class="tag" :key="tag">{{ tag }}</span>`
        };
        //single post component
    const singlePostComponent = {
        props: ['post'],
        // Register child components. The property must be 'components' (plural).
        // The key 'tag-component' matches the tag used in the template below.
        components: { 'tags': tagComponent },
        template: `
        <article class="post-card">
            <h2>{{ post.title }}</h2>
            <p>{{ post.body }}</p>
            <div class="post-meta">
                <div class="tags">
                    <tags v-for="tag in post.tags" :key="tag" :tag="tag"></tags>
                </div>
                <div class="reactions">❤️ {{ post.reactions }}</div>                
            </div>
        </article>
        `    };

    const titleComponent = {
        props: ['title'],
        template: `<h1>{{ title }}</h1>`
    };

    // Create the Vue Application using the Options API
    const { createApp } = Vue;
    //createApp({object}).mount('#app');
    createApp({
        // The data() method returns the initial reactive state for the component.
        data() {
        return {
            posts: [],
            loading: true,
            error: null,
            title: 'Posts List (Options API)'
        }
        },
        components: {
            'single-article': singlePostComponent,
            'tag-component': tagComponent,
            'title-component': titleComponent
        },
    
        // The computed() method returns reactive computed properties for the component.
        computed: {
        sortedPosts() {
            return this.posts.slice().sort((a, b) => b.reactions - a.reactions);
        }
        },
        // The methods() method returns reactive methods for the component.
        methods: {
        fetchPosts() {
           this.posts = [{
            id:1, title: 'Post One', body: 'This is the body of post one.', tags: ['news', 'events'], reactions: 5
           }, {
            id:2, title: 'Post Two', body: 'This is the body of post two.', tags: ['updates', 'news'], reactions: 10
           }, {
            id:3, title: 'Post Three', body: 'This is the body of post three.', tags: ['events', 'updates'], reactions: 3
           }, {
            id:4, title: 'Post Four', body: 'This is the body of post four.', tags: ['news'], reactions: 8
           }];           
           this.loading = false;
           this.error = null;
        }
        },
        // The mounted() lifecycle hook is called after the component is mounted to the DOM.
        mounted() {
        this.fetchPosts();
        }
    }).mount('#app'); // Mount the app to the #app div
</script>
</html>